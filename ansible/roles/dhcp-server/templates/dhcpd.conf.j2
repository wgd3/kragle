# dhcpd.conf
#

default-lease-time 600;
max-lease-time 7200;

authoritative;

option hanlon_server code 224 = ip-address;
option hanlon_port code 225 = unsigned integer 16;
option hanlon_base_uri code 226 = text;

subnet {{ pxe_subnet_name }} netmask {{ pxe_subnet_mask }} {
    range                       {{ pxe_dhcp_range_start }} {{ pxe_dhcp_range_end }};
    option routers              {{ pxe_gateway }};
    option subnet-mask          {{ pxe_subnet_mask }};
    option domain-name          "{{ domain_name }}";
    option domain-name-servers  {{ dns1 }};
    next-server                 {{ auto_deploy_node }};
    option tftp-server-name     "{{ auto_deploy_node }}";
    option hanlon_server        {{ auto_deploy_node }};
    option hanlon_port          8026;
    option hanlon_base_uri      "/hanlon/api/v1";

    if exists user-class and option user-class = "iPXE" {
        filename "hanlon.ipxe";
    } else {
        filename "undionly.kpxe";
    }
}
